/*
 * Copyright (C) 2017, Intel Corporation
 *
 * based on socfpga_cyclone5_de10_nano_soc.dts
 *
 * SPDX-License-Identifier:	GPL-2.0+
 */

#include "socfpga_cyclone5.dtsi"

/ {
	model = "Terasic DE10-Nano";
	compatible = "altr,socfpga-cyclone5", "altr,socfpga";

	chosen {
		bootargs = "console=ttyS0,115200n8 earlyprintk=serial,ttyS0,115200n8 uio_pdrv_genirq.of_id=generic-uio";
		stdout-path = "display0";
	};

	aliases {
		ethernet0 = &gmac1;
		udc0 = &usb1;
		display0 = &framebuffer;
	};

	memory {
		name = "memory";
		device_type = "memory";
		reg = <0x0 0x40000000>; /* 1GB */
	};

        regulator_3_3v: 3-3-v-regulator {
                compatible = "regulator-fixed";
                regulator-name = "3.3V";
                regulator-min-microvolt = <3300000>;
                regulator-max-microvolt = <3300000>;
        };

	soc {
		u-boot,dm-pre-reloc;

		clkmgr@ffd04000 {
			clocks {
				osc1 {
					clock-frequency = <50000000>;
				};
			};
		};

		hps_led {
		    compatible = "gpio-leds";
		    label = "hps:blue:led0";
		    gpios = <&portb 24 0>; /* HPS_GPIO53 */
		    linux,default-trigger = "heartbeat";
		};
		
		hps_0_bridges: bridge@c0000000 {
		    compatible = "altr,bridge-18.1", "simple-bus";
		    reg = <0xc0000000 0x20000000>, <0xff200000 0x00200000>;
		    reg-names = "axi_h2f", "axi_h2f_lw";
		    #address-cells = <2>;
		    #size-cells = <1>;
		
		    ranges =	<0x00000001 0x00000060 0xff200060 0x00000008>,
				<0x00000001 0x00000040 0xff200040 0x00000010>,
				<0x00000001 0x00000030 0xff200030 0x00000010>,
				<0x00000001 0x00000020 0xff200020 0x00000010>,
				<0x00000001 0x00000010 0xff200010 0x00000010>,
				<0x00000001 0x00000000 0xff200000 0x00000010>,
				<0x00000001 0x00000050 0xff200050 0x00000008>,
				<0x00000001 0x00000058 0xff200058 0x00000008>,
				<0x00000001 0x00010000 0xff210000 0x00010000>,
				<0x00000001 0x00008000 0xff208000 0x00000040>,
				<0x00000001 0x0000b000 0xff20b000 0x00000020>,
				<0x00000001 0x0000c000 0xff20c000 0x00000020>,
				<0x00000001 0x0000d000 0xff20d000 0x00000020>;

		    jtag_uart: serial@100000060 {
			compatible = "altr,juart-18.1", "altr,juart-1.0";
			reg = <0x00000001 0x00000060 0x00000008>;
			interrupt-parent = <&intc>;
			interrupts = <0 41 4>;
			clocks = <&osc1>;
		    };

		    fpga_leds: gpio@100000040 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x00000040 0x00000010>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <7>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    dipsw_pio: gpio@100000030 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x00000030 0x00000010>;
			interrupt-parent = <&intc>;
			interrupts = <0 42 1>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <4>;
			altr,interrupt-type = <3>;
			edge_type = <2>;
			level_trigger = <0>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    button_pio: gpio@100000020 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x00000020 0x00000010>;
			interrupt-parent = <&intc>;
			interrupts = <0 43 1>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <2>;
			altr,interrupt-type = <2>;
			edge_type = <1>;
			level_trigger = <0>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    psu_button: power_button@100000010 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x00000010 0x00000010>;
			interrupt-parent = <&intc>;
			interrupts = <0 46 4>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <1>;
			altr,interrupt-type = <4>;
			altr,ngpio = <1>;
			level_trigger = <1>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
			reg-names = "pressed";
		    };

		    psu_poweroff_req: power_down@100000000 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x00000000 0x00000010>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <1>;
			altr,ngpio = <1>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
			reg-names = "signal";
		    };

		    locked_pio: gpio@10000d000 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x0000d000 0x00000020>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <1>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    cvo_reset_pio: gpio@10000c000 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x0000c000 0x00000020>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <1>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    pll_reset_pio: gpio@10000b000 {
			compatible = "altr,pio-18.1", "altr,pio-1.0";
			reg = <0x00000001 0x0000b000 0x00000020>;
			clocks = <&osc1>;
			altr,gpio-bank-width = <1>;
			resetvalue = <0>;
			#gpio-cells = <2>;
			gpio-controller;
		    };

		    sysid_qsys: sysid@100000058 {
			compatible = "altr,sysid-18.1", "altr,sysid-1.0";
			reg = <0x00000001 0x00000058 0x00000008>;
			id = <2899645442>;
			timestamp = <1515961589>;
		    };

		    hm2reg_io_0: hm2-socfpga0@100010000 {
			compatible = "generic-uio";
			reg = <0x00000001 0x00010000 0x00010000>;
			interrupt-parent = <&intc>;
			interrupts = <0 44 4>;
			clocks = <&osc1>;
			address_width = <14>;
			data_width = <32>;
		    };

		    adc_ltc2308_fifo_0: adc-ltc2308@100000050 {
			compatible = "holotc,adc-io-1.1";
			reg = <0x00000001 0x00000050 0x00000008>;
			address_width = <3>;
			data_width = <16>;
		    };

		    framebuffer: framebuffer@100008000 {
			compatible = "altr,vip-18.1", "altr,vip-frame-buffer-2.0";
			reg = <0x00000001 0x00008000 0x00000040>;
			interrupt-parent = <&intc>;
			interrupts = <0 40 4>;
			altr,bits-per-symbol = <8>;
			altr,max-width = <1024>;
			altr,max-height = <768>;
			altr,mem-port-width = <256>;
		    };
		};
	};
	
	gpio-poweroff {
	    compatible = "gpio-poweroff";
	    gpios = <&psu_poweroff_req 0 0>;
	    status = "okay";
	};
};

&gmac1 {
	status = "okay";
	phy-mode = "rgmii";

	rxd0-skew-ps = <420>;
	rxd1-skew-ps = <420>;
	rxd2-skew-ps = <420>;
	rxd3-skew-ps = <420>;
	txen-skew-ps = <0>;
	txc-skew-ps = <1860>;
	rxdv-skew-ps = <420>;
	rxc-skew-ps = <1680>;
};

&gpio0 {
	status = "disabled";
};

&gpio1 {
	status = "okay";
};

&gpio2 {
	status = "disabled";
};

&mmc0 {
	status = "okay";
};

&usb1 {
	dr_mode = "host";
	status = "okay";
};

&i2c0 {
	status = "okay";
	clock-frequency = <100000>;

	adxl345: adxl345@0 {
		compatible = "adi,adxl345";
		reg = <0x53>;

		interrupt-parent = <&portc>;
		interrupts = <3 2>;
	};
};

&i2c1 {
	status = "okay";
	clock-frequency = <400000>;

	rtc_m41t80: m41t80@0 {
		compatible = "st,m41t81";
		reg = <0x68>;
	};
};

&i2c2 {
	status = "okay";
	clock-frequency = <400000>;
};
